<header class="header-executive nav-modern" id="modern-nav">
  <div class="header-container">
    <div class="header-logo nav-brand">
      <a href="{{ "/" | relative_url }}" class="brand-link">
        <img src="/assets/images/logo.png" alt="Nicolas DabÃ¨ne" class="logo animate-float" width="95" height="95">
      </a>
    </div>
    
    <nav class="header-nav main-navigation">
      <ul class="nav-links">
        {% for item in site.data.navigation %}
          <li class="nav-item">
            <a href="{{ item.link | relative_url }}" 
               class="nav-link {% if page.url == item.link %}active{% endif %}">
              {{ item.name }}
            </a>
          </li>
        {% endfor %}
      </ul>
    </nav>

    <div class="header-actions nav-actions">
      <a href="{{ "/contact" | relative_url }}" class="btn btn--primary ripple-effect">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z" stroke="currentColor" stroke-width="2"/>
          <polyline points="22,6 12,13 2,6" stroke="currentColor" stroke-width="2"/>
        </svg>
        Me contacter
      </a>
      
      <button class="mobile-menu-btn" id="mobile-menu-toggle">
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
        <span class="hamburger-line"></span>
      </button>
    </div>
  </div>

  <!-- Mobile Navigation - Version simple -->
  <div class="mobile-nav" id="mobile-nav-panel">
    <ul>
      {% for item in site.data.navigation %}
        <li>
          <a href="{{ item.link | relative_url }}" class="mobile-nav-link {% if page.url == item.link %}active{% endif %}">
            {{ item.name }}
          </a>
        </li>
      {% endfor %}
      <li><a href="{{ "/contact" | relative_url }}" class="btn btn--primary">Discutons de votre projet</a></li>
    </ul>
  </div>
</header>

<style></style>

<script>
  // JavaScript simple pour la navigation
  document.addEventListener('DOMContentLoaded', function() {
    const nav = document.getElementById('modern-nav');
    const themeToggle = document.getElementById('theme-toggle');
    function updateBodyOffset() {
      if (!nav) return;
      const isMobile = window.innerWidth <= 768;
      const isTablet = window.innerWidth > 768 && window.innerWidth <= 1024;
      const navHeight = nav.offsetHeight || 72;
      // Publier uniquement via variable CSS + scroll-padding
      const offset = (isMobile || isTablet) ? navHeight : 0;
      document.documentElement.style.setProperty('--nav-offset', offset + 'px');
      document.documentElement.style.scrollPaddingTop = offset + 'px';
      document.body.style.paddingTop = '';
    }
    
    // Scroll effect
    window.addEventListener('scroll', () => {
      if (window.scrollY > 50) {
        nav?.classList.add('scrolled');
      } else {
        nav?.classList.remove('scrolled');
      }
    });
    // Set initial offset and on resize/load
    requestAnimationFrame(updateBodyOffset);
    window.addEventListener('load', updateBodyOffset);
    window.addEventListener('resize', updateBodyOffset);
    // Observe nav size changes (fonts, dynamic content)
    try {
      const ro = new ResizeObserver(updateBodyOffset);
      nav && ro.observe(nav);
    } catch(_) {}

    // Mobile menu toggle - Fixed with debug
    const mobileToggle = document.getElementById('mobile-menu-toggle');
    const mobileNav = document.getElementById('mobile-nav-panel');
    
    console.log('Mobile elements found:', {
      toggle: !!mobileToggle,
      nav: !!mobileNav,
      screenWidth: window.innerWidth
    });
    
    if (mobileToggle && mobileNav) {
      mobileToggle.addEventListener('click', (e) => {
        e.preventDefault();
        e.stopPropagation();
        
        const isOpen = mobileNav.classList.contains('open');
        console.log('Menu toggle clicked, currently open:', isOpen);
        
        if (isOpen) {
          mobileNav.classList.remove('open');
          mobileToggle.classList.remove('active');
          document.body.style.overflow = '';
        } else {
          mobileNav.classList.add('open');
          mobileToggle.classList.add('active');
          document.body.style.overflow = 'hidden';
        }
        
        console.log('Menu state after toggle:', mobileNav.classList.contains('open'));
      });
      
      // Close mobile nav when clicking on links
      const mobileLinks = mobileNav.querySelectorAll('a');
      mobileLinks.forEach(link => {
        link.addEventListener('click', () => {
          mobileNav.classList.remove('open');
          mobileToggle.classList.remove('active');
          document.body.style.overflow = '';
        });
      });
      
      // Close when clicking outside
      document.addEventListener('click', (e) => {
        if (!mobileNav.contains(e.target) && !mobileToggle.contains(e.target)) {
          mobileNav.classList.remove('open');
          mobileToggle.classList.remove('active');
          document.body.style.overflow = '';
        }
      });
    }

    // Theme toggle
    themeToggle?.addEventListener('click', () => {
      const sunIcon = themeToggle.querySelector('.sun');
      const moonIcon = themeToggle.querySelector('.moon');
      
      sunIcon.classList.toggle('hidden');
      moonIcon.classList.toggle('hidden');
      
      document.body.classList.toggle('dark-theme');
    });
  });
</script> 