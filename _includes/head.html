<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

<!-- Métadonnées optimisées pour IA génératives (GEO) -->
<title>{{ site.title }} | {{ page.title }}</title>
{% if page.layout == 'quiz' %}
<meta name="description" content="{{ page.subtitle | default: page.description }} {% if page.questions_count %}{{ page.questions_count }} questions{% endif %}{% if page.difficulty %} • {{ page.difficulty }}{% endif %}{% if page.topics %} • {{ page.topics | join: ', ' }}{% endif %}">
{% else %}
<meta name="description" content="{{ page.description | default: page.excerpt | strip_html | strip | truncatewords: 30 | default: site.description }}">
{% endif %}
{% assign current_lang = page.lang | default: site.default_lang %}
<link rel="canonical" href="{{ page.url | absolute_url }}">

<!-- Balises hreflang pour SEO multilingue -->
<link rel="alternate" hreflang="{{ current_lang }}" href="{{ page.url | absolute_url }}">

{% comment %} Pour les articles : trouver la traduction via le système de ref {% endcomment %}
{% if page.ref %}
  {% assign all_posts = site.posts | concat: site.posts_en %}
  {% for alt_post in all_posts %}
    {% if alt_post.ref == page.ref and alt_post.lang != current_lang %}
      <link rel="alternate" hreflang="{{ alt_post.lang }}" href="{{ alt_post.url | absolute_url }}">
    {% endif %}
  {% endfor %}

  {% comment %} x-default pointe vers la version française {% endcomment %}
  {% if current_lang == 'fr' %}
    <link rel="alternate" hreflang="x-default" href="{{ page.url | absolute_url }}">
  {% else %}
    {% for alt_post in all_posts %}
      {% if alt_post.ref == page.ref and alt_post.lang == 'fr' %}
        <link rel="alternate" hreflang="x-default" href="{{ alt_post.url | absolute_url }}">
      {% endif %}
    {% endfor %}
  {% endif %}
{% else %}
  {% comment %} Pour les pages statiques : construire les URLs alternates {% endcomment %}
  {% if current_lang == 'fr' %}
    {% if page.url == '/' or page.url == '/index.html' %}
      {% assign en_url = '/en/' %}
    {% else %}
      {% assign en_url = page.url | prepend: '/en' %}
    {% endif %}
    <link rel="alternate" hreflang="en" href="{{ en_url | absolute_url }}">
    <link rel="alternate" hreflang="x-default" href="{{ page.url | absolute_url }}">
  {% else %}
    {% assign fr_url = page.url | remove_first: '/en' %}
    {% if fr_url == '' or fr_url == '/' %}
      {% assign fr_url = '/' %}
    {% endif %}
    <link rel="alternate" hreflang="fr" href="{{ fr_url | absolute_url }}">
    <link rel="alternate" hreflang="x-default" href="{{ fr_url | absolute_url }}">
  {% endif %}
{% endif %}

{% if page.alternates %}
{% for alt in page.alternates %}
<link rel="alternate" hreflang="{{ alt.lang }}" href="{{ alt.url | absolute_url }}">
{% endfor %}
{% endif %}

<!-- RSS Feeds par langue (pour éviter les doublons dans les automatisations) -->
{% if current_lang == 'fr' %}
  <link rel="alternate" type="application/rss+xml" title="{{ site.title }} - Flux RSS Français" href="{{ '/feed.xml' | absolute_url }}" />
  <link rel="alternate" type="application/rss+xml" title="{{ site.title }} - English RSS Feed" href="{{ '/feed_en.xml' | absolute_url }}" hreflang="en" />
{% else %}
  <link rel="alternate" type="application/rss+xml" title="{{ site.title }} - English RSS Feed" href="{{ '/feed_en.xml' | absolute_url }}" />
  <link rel="alternate" type="application/rss+xml" title="{{ site.title }} - Flux RSS Français" href="{{ '/feed.xml' | absolute_url }}" hreflang="fr" />
{% endif %}

<meta property="og:site_name" content="{{ site.title }}">
<meta property="og:locale" content="{% if current_lang == 'fr' %}fr_FR{% else %}en_US{% endif %}">
<!-- Generative Engine Optimisation (GEO) helpers -->
{% if page.llm_summary %}
<meta name="llm:summary" content="{{ page.llm_summary | escape }}">
{% else %}
<meta name="llm:summary" content="{{ page.description | default: page.excerpt | strip_html | strip | default: site.description }}">
{% endif %}
{% if page.llm_topics %}
<meta name="llm:topics" content="{{ page.llm_topics | join: ', ' | escape }}">
{% else %}
<meta name="llm:topics" content="formations, e‑books, IA, PrestaShop, développement, prompts, bonnes pratiques, expert PHP, développeur FullStack, architecture e-commerce, modules PrestaShop, intelligence artificielle, orchestration IA">
{% endif %}
<meta name="keywords" content="{{ page.keywords | default: site.keywords }}">
<meta name="author" content="{{ site.author.name }}">
{% comment %} Gestion intelligente des balises robots pour hide_until_published {% endcomment %}
{% if is_future_post %}
  {% comment %} Article futur avec hide_until_published : bloquer l'indexation {% endcomment %}
  <meta name="robots" content="noindex, nofollow">
{% elsif is_published_post %}
  {% comment %} Article publié avec hide_until_published : forcer l'indexation {% endcomment %}
  <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
{% elsif page.robots %}
  {% comment %} Utiliser la valeur personnalisée si définie {% endcomment %}
  <meta name="robots" content="{{ page.robots }}">
{% else %}
  {% comment %} Défaut pour tous les autres contenus {% endcomment %}
  <meta name="robots" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
{% endif %}

<meta name="ai-content-type" content="{% if page.layout == 'post' %}technical-article{% elsif page.layout == 'project' %}portfolio-project{% elsif page.layout == 'quiz' %}interactive-quiz{% else %}professional-profile{% endif %}">
<meta name="expertise-level" content="{% if page.difficulty %}{{ page.difficulty }}{% else %}expert{% endif %}">
{% if page.layout == 'quiz' %}
<meta name="quiz-questions-count" content="{{ page.questions_count }}">
{% if page.topics %}
<meta name="quiz-topics" content="{{ page.topics | join: ', ' }}">
{% endif %}
{% endif %}
<meta name="content-category" content="{% for category in page.categories %}{{ category }}{% unless forloop.last %}, {% endunless %}{% endfor %}">
<meta name="target-audience" content="developers, software architects, cto, technical leaders">
<meta name="reading-time" content="{% if page.layout == 'post' %}{{ content | number_of_words | divided_by: 200 | ceil }} minutes{% else %}2 minutes{% endif %}">
<meta name="content-freshness" content="{{ page.date | default: site.time | date_to_xmlschema }}">
{% if page.ai_intent %}<meta name="ai-intent" content="{{ page.ai_intent }}">{% endif %}
{% if page.ai_primary_action %}<meta name="ai-primary-action" content="{{ page.ai_primary_action }}">{% endif %}
{% if page.ai_topics %}<meta name="ai-topics" content="{% if page.ai_topics.size %}{{ page.ai_topics | join: ', ' }}{% else %}{{ page.ai_topics }}{% endif %}">{% endif %}

{% if page.layout == 'post' %}
<!-- Métadonnées spécifiques aux articles techniques -->
<meta name="article-type" content="technical-tutorial">
<meta name="code-samples" content="{% if content contains '```' %}true{% else %}false{% endif %}">
<meta name="practical-examples" content="true">
<meta name="learning-outcomes" content="{{ page.excerpt | strip_html | strip }}">
{% endif %}

{% if page.technologies %}
<meta name="technologies" content="{{ page.technologies | join: ', ' }}">
{% endif %}

<!-- Citation et autorité -->
<meta name="author-expertise" content="15+ years PHP development, PrestaShop expert, AI integration specialist">
<meta name="content-authority" content="primary-source">
<meta name="fact-check-worthy" content="true">
<meta name="llm:intent" content="{% if page.layout == 'post' %}educational{% elsif page.layout == 'project' %}portfolio-showcase{% elsif page.layout == 'product' %}purchase-consideration{% elsif page.layout == 'quiz' %}skill-assessment{% else %}professional-discovery{% endif %}">
<meta name="llm:audience" content="developers, CTOs, business leaders, e-commerce professionals">
<meta name="llm:content-depth" content="{% if page.layout == 'post' or page.layout == 'quiz' %}expert{% else %}overview{% endif %}">
<meta name="llm:industry-focus" content="e-commerce, PHP development, AI integration">
<meta name="llm:geographic-focus" content="France, Europe, international e-commerce">

<!-- Open Graph / Facebook -->
{% if page.layout == 'product' and page.product %}
  {% assign _og_image = page.product.image | absolute_url %}
{% elsif page.layout == 'quiz' %}
  {% comment %} Image spécifique pour les quiz, ou image par défaut des quiz {% endcomment %}
  {% if page.image %}
    {% assign _og_image = page.image | absolute_url %}
  {% else %}
    {% assign _og_image = '/assets/images/quiz-og-default.jpg' | absolute_url %}
  {% endif %}
{% elsif page.image %}
  {% assign _og_image = page.image | absolute_url %}
{% else %}
  {% assign _og_image = '/assets/images/hero/profile-hero.jpg' | absolute_url %}
{% endif %}
<meta property="og:type" content="{% if page.layout == 'product' %}product{% elsif page.layout == 'post' or page.layout == 'quiz' %}article{% else %}website{% endif %}">
<meta property="og:url" content="{{ page.url | absolute_url }}">
<meta property="og:title" content="{{ site.title }} | {{ page.title }}">
{% if page.layout == 'quiz' %}
<meta property="og:description" content="{{ page.subtitle | default: page.description }} {% if page.questions_count %}{{ page.questions_count }} questions{% endif %}{% if page.difficulty %} • {{ page.difficulty }}{% endif %}{% if page.topics %} • {{ page.topics | join: ', ' }}{% endif %}">
{% else %}
<meta property="og:description" content="{{ page.description | default: page.excerpt | strip_html | strip | truncatewords: 30 | default: site.description }}">
{% endif %}
<meta property="og:image" content="{{ _og_image }}">
<meta property="og:image:secure_url" content="{{ _og_image }}">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">
<meta property="og:image:alt" content="{{ page.title | escape }}">
<meta property="og:image:type" content="image/jpeg">
{% if page.layout == 'product' and page.product and page.product.prix %}
  <meta property="product:price:amount" content="{{ page.product.prix | remove: '€' | strip }}">
  <meta property="product:price:currency" content="EUR">
{% endif %}
<meta property="og:site_name" content="{{ site.title }}">
<meta property="og:locale" content="{% if current_lang == 'fr' %}fr_FR{% else %}en_US{% endif %}">
{% if page.layout == 'post' or page.layout == 'quiz' %}
<meta property="article:published_time" content="{{ page.date | default: site.time | date_to_xmlschema }}">
{% if page.last_modified_at %}
<meta property="article:modified_time" content="{{ page.last_modified_at | date_to_xmlschema }}">
{% endif %}
<meta property="article:author" content="{{ page.author | default: site.author.name }}">
{% if page.categories %}
  {% for category in page.categories %}
<meta property="article:section" content="{{ category }}">
  {% endfor %}
{% endif %}
{% if page.tags %}
  {% for tag in page.tags %}
<meta property="article:tag" content="{{ tag }}">
  {% endfor %}
{% endif %}
{% if page.layout == 'quiz' and page.topics %}
  {% for topic in page.topics %}
<meta property="article:tag" content="{{ topic }}">
  {% endfor %}
{% endif %}
{% endif %}

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:site" content="@nicolasdabene">
<meta name="twitter:creator" content="@nicolasdabene">
<meta name="twitter:url" content="{{ page.url | absolute_url }}">
<meta name="twitter:title" content="{{ site.title }} | {{ page.title }}">
{% if page.layout == 'quiz' %}
<meta name="twitter:description" content="{{ page.subtitle | default: page.description }} {% if page.questions_count %}{{ page.questions_count }} questions{% endif %}{% if page.difficulty %} • {{ page.difficulty }}{% endif %}{% if page.topics %} • {{ page.topics | join: ', ' }}{% endif %}">
{% else %}
<meta name="twitter:description" content="{{ page.description | default: page.excerpt | strip_html | strip | truncatewords: 30 | default: site.description }}">
{% endif %}
<meta name="twitter:image" content="{{ _og_image }}">
<meta name="twitter:image:alt" content="{{ page.title | escape }}">

<!-- Favicon -->
<link rel="icon" type="image/png" href="/assets/images/favicon.png">
<link rel="manifest" href="/manifest.json">

<!-- Couleurs et modes -->
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark">
<meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#ffffff">
<meta name="mobile-web-app-capable" content="yes">
<meta name="mobile-web-app-status-bar-style" content="default">
<meta name="msapplication-navbutton-color" content="#ffffff">
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="msapplication-config" content="none">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="light-content">
<meta name="apple-mobile-web-app-title" content="Nicolas Dabène">
<meta name="format-detection" content="telephone=no">
<meta name="color-profile" content="sRGB">
<meta name="color-rendering" content="optimizeQuality">

{% comment %} Redirection pour les articles avec hide_until_published: true {% endcomment %}
{% if page.hide_until_published == true and page.layout == 'post' %}
  {% comment %} Calculer si la date de publication est dans le futur {% endcomment %}
  {% assign current_timestamp = 'now' | date: '%s' | plus: 0 %}
  {% assign post_timestamp = page.date | date: '%s' | plus: 0 %}
  {% if post_timestamp > current_timestamp %}
    <meta http-equiv="refresh" content="0; url={{ '/' | absolute_url }}">
    {% assign is_future_post = true %}
  {% else %}
    {% assign is_published_post = true %}
  {% endif %}
{% endif %}

<!-- Force le rendu sRGB -->
<style>
  * {
    -webkit-color-profile: sRGB !important;
    color-profile: sRGB !important;
  }
</style>

{% include critical-css.html %}

<!-- Critical CSS for Hero section - Mobile LCP optimization -->
{% include critical-hero-css.html %}

<!-- Preload critical LCP image (hero) with highest priority -->
<link rel="preload" as="image" href="/assets/images/hero/profile-hero.webp" type="image/webp" fetchpriority="high">
<link rel="preload" as="image" href="/assets/images/hero/profile-hero.jpg" type="image/jpeg" fetchpriority="high">

<!-- Styles - Preload pour CSS critiques -->
{% if site.cache_busting %}
  {% assign cache_buster = site.time | date: '%s' %}
{% endif %}
<link rel="preload" href="{{ '/assets/css/style.css' | relative_url }}{% if cache_buster %}?v={{ cache_buster }}{% endif %}" as="style">
<link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}{% if cache_buster %}?v={{ cache_buster }}{% endif %}">
<link rel="preload" href="{{ '/assets/css/homepage-cards.css' | relative_url }}{% if cache_buster %}?v={{ cache_buster }}{% endif %}" as="style">
<link rel="stylesheet" href="{{ '/assets/css/homepage-cards.css' | relative_url }}{% if cache_buster %}?v={{ cache_buster }}{% endif %}">

<!-- Preconnect optimisé pour ressources tierces critiques -->
<link rel="preconnect" href="https://www.googletagmanager.com">
<link rel="preconnect" href="https://cdnjs.cloudflare.com">

<!-- Google Fonts - Optimisé pour performance mobile -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<!-- Réduit aux poids essentiels + font-display swap pour éviter FOIT -->
<link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;600&display=swap" as="style">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet" media="print" onload="this.media='all'">
<noscript><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet"></noscript>

<!-- FontAwesome pour les icônes sociales - Chargement optimisé -->
<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" media="print" onload="this.media='all'">
<noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer"></noscript>

<!-- Scripts critiques uniquement - Autres scripts chargés dans body -->

<!-- Schema.org Markup - Optimisé pour performance -->
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"Person","name":"{{ site.author.name }}","url":"{{ site.url }}","image":"{{ site.url }}/assets/images/hero/profile-hero.jpg","jobTitle":"Senior PHP FullStack Developer & AI Orchestrator","email":"{{ site.author.email }}","address":{"@type":"PostalAddress","addressCountry":"FR"},"sameAs":["https://www.linkedin.com/in/nicolas-dabene/","https://github.com/ndabene"],"knowsAbout":["PHP Development","PrestaShop E-commerce","AI Integration","Web Performance Optimization"]}
</script>
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","name":"{{ page.title | escape }}","description":"{{ page.description | default: page.excerpt | strip_html | strip | truncatewords: 20 | default: site.description | escape }}","url":"{{ page.url | absolute_url }}","inLanguage":"{% if current_lang == 'fr' %}fr-FR{% else %}en-US{% endif %}"}
</script>

{% include breadcrumb-jsonld.html %}
{% include quiz-jsonld.html %}

<!-- Resource hint pour le cookie banner Google Funding Choices -->
<link rel="dns-prefetch" href="https://fundingchoicesmessages.google.com">