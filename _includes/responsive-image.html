{% comment %}
  Composant d'image responsive optimisé WebP avec fallback

  Usage dans un article ou layout:
  {% include responsive-image.html
     src="/assets/images/blog/mon-image.jpg"
     alt="Description de l'image"
     width="1200"
     height="630"
     loading="lazy"
     class="post-banner-image"
  %}

  Le composant:
  1. Génère automatiquement le chemin WebP
  2. Utilise <picture> avec fallback JPG
  3. Ajoute loading lazy par défaut
  4. Inclut dimensions pour éviter CLS
{% endcomment %}

{% assign image_path = include.src %}
{% assign webp_path = image_path | replace: '.jpg', '.webp' | replace: '.jpeg', '.webp' | replace: '.png', '.webp' %}
{% assign alt_text = include.alt | default: "Image" %}
{% assign width = include.width | default: "1200" %}
{% assign height = include.height | default: "630" %}
{% assign loading = include.loading | default: "lazy" %}
{% assign css_class = include.class | default: "" %}
{% assign itemprop = include.itemprop %}

<picture{% if css_class != "" %} class="{{ css_class }}"{% endif %}>
  {%- comment -%} Source WebP (prioritaire) {%- endcomment -%}
  <source srcset="{{ webp_path | relative_url }}" type="image/webp">

  {%- comment -%} Fallback JPG/PNG {%- endcomment -%}
  <img
    src="{{ image_path | relative_url }}"
    alt="{{ alt_text | escape }}"
    width="{{ width }}"
    height="{{ height }}"
    loading="{{ loading }}"
    decoding="async"
    {% if itemprop %}itemprop="{{ itemprop }}"{% endif %}
  >
</picture>
