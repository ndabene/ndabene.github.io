{% comment %}
  Génère un schéma JSON-LD BreadcrumbList lorsque la page possède une hiérarchie.
  - Utilise `page.breadcrumbs` si défini (liste d'objets `{ name, url }`).
  - Sinon gère automatiquement les articles (`layout: post`) et produits (`layout: product`).
{% endcomment %}

{% if page.breadcrumbs %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {% for crumb in page.breadcrumbs %}
    {
      "@type": "ListItem",
      "position": {{ forloop.index }},
      "name": "{{ crumb.name | escape }}",
      "item": "{{ crumb.url | absolute_url }}"
    }{% unless forloop.last %},{% endunless %}
    {% endfor %}
  ]
}
</script>
{% elsif page.layout == 'post' %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    { "@type": "ListItem", "position": 1, "name": "Accueil", "item": "{{ '/' | absolute_url }}" },
    { "@type": "ListItem", "position": 2, "name": "Blog", "item": "{{ '/blog/' | absolute_url }}" }{% if page.categories and page.categories.size > 0 %},
    { "@type": "ListItem", "position": 3, "name": "{{ page.categories[0] | escape }}", "item": "{{ '/blog/' | append: page.categories[0] | slugify | append: '/' | absolute_url }}" },
    { "@type": "ListItem", "position": 4, "name": "{{ page.title | escape }}", "item": "{{ page.url | absolute_url }}" }{% else %},
    { "@type": "ListItem", "position": 3, "name": "{{ page.title | escape }}", "item": "{{ page.url | absolute_url }}" }{% endif %}
  ]
}
</script>
{% elsif page.layout == 'product' %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    { "@type": "ListItem", "position": 1, "name": "Accueil", "item": "{{ '/' | absolute_url }}" },
    { "@type": "ListItem", "position": 2, "name": "Boutique", "item": "{{ '/boutique/' | absolute_url }}" },
    { "@type": "ListItem", "position": 3, "name": "{{ page.title | escape }}", "item": "{{ page.url | absolute_url }}" }
  ]
}
</script>
{% endif %}

