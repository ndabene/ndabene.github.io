name: Validate Articles Structure

on:
  push:
    branches:
      - main
      - 'claude/**'
    paths:
      - '_posts/**/*.md'
      - '_posts_en/**/*.md'
  pull_request:
    paths:
      - '_posts/**/*.md'
      - '_posts_en/**/*.md'

jobs:
  validate:
    name: Validate Articles
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Make validation script executable
        run: chmod +x .claude/validate-articles.sh

      - name: Run article validation
        id: validate
        run: |
          echo "üîç Validation de la structure des articles..."
          bash .claude/validate-articles.sh
        continue-on-error: true

      - name: Check validation result
        if: steps.validate.outcome == 'failure'
        run: |
          echo "‚ùå La validation a √©chou√©. Consultez les logs ci-dessus pour les d√©tails."
          echo ""
          echo "üìñ Pour corriger les erreurs :"
          echo "   1. Consultez .claude/article-publication-guidelines.md"
          echo "   2. Corrigez les probl√®mes identifi√©s"
          echo "   3. Relancez localement : bash .claude/validate-articles.sh"
          echo "   4. Commitez et pushez vos corrections"
          exit 1

      - name: Validation success
        if: steps.validate.outcome == 'success'
        run: |
          echo "‚úÖ Validation r√©ussie ! La structure des articles est correcte."
